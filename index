<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Carta Interactiva ‚Äî Viaje de Recuerdos</title>
<style>
  :root{
    /* ====== COLORES PRINCIPALES (C√ÅMBIALOS) ====== */
    --bg: #0b0f19;
    --card: #10172a;
    --ink: #e5e7eb;
    --accent: #f472b6;   /* rosado */
    --accent2:#93c5fd;   /* celeste */
    --muted: #94a3b8;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:
      radial-gradient(1200px 600px at 80% 0%, #0f1730 0%, #0b1224 45%, var(--bg) 100%);
    color:var(--ink); font-family: system-ui,Segoe UI,Inter,Roboto,Arial; 
    display:grid; place-items:center; padding:12px;
  }

  /* ====== CONTENEDOR ====== */
  .shell{
    width:min(900px,96vw);
  }
  .card{
    position:relative; overflow:hidden;
    background:linear-gradient(180deg, #0e1528, #0a1222);
    border:1px solid rgba(148,163,184,.18);
    border-radius:18px; padding:18px;
    box-shadow: 0 20px 55px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.03);
  }

  /* ====== HEADER ====== */
  .head{
    display:flex; align-items:center; justify-content:space-between;
    gap:12px; margin-bottom:8px;
  }
  .title{ font-weight:700; letter-spacing:.4px }
  .subtitle{ color:var(--muted); font-size:.9rem }

  /* ====== PROGRESO ====== */
  .progress{
    height:6px; background:#0e162a; border-radius:999px; overflow:hidden;
    border:1px solid rgba(148,163,184,.18); margin:10px 0 14px;
  }
  .bar{ height:100%; width:0%; background:linear-gradient(90deg, var(--accent), var(--accent2)); }

  /* ====== SLIDES ====== */
  .slides{ position:relative; height:min(60vh,520px); border-radius:12px; overflow:hidden; }
  .slide{
    position:absolute; inset:0; display:grid; grid-template-columns: 1fr;
    grid-template-rows: 60% 40%; gap:0; padding:10px; opacity:0; transform:translateX(30px) scale(.98);
    transition: opacity .45s ease, transform .45s ease;
  }
  .slide.active{ opacity:1; transform:translateX(0) scale(1); }
  .media{
    border-radius:12px; background:#0c152b; border:1px solid rgba(148,163,184,.14);
    display:grid; place-items:center; overflow:hidden;
  }
  /* Coloca tu imagen de fondo por slide con inline style (ver abajo) */
  .media .ph{
    opacity:.8; color:#9ca3af; font-size:.9rem; text-align:center; padding:10px;
  }
  .text{
    padding:14px 10px 6px; line-height:1.55; font-size:1.05rem;
  }
  .type{ min-height:3.5em; white-space:pre-wrap; }
  .hint{ color:var(--muted); font-size:.85rem; margin-top:6px }

  /* ====== CONTROLES ====== */
  .controls{
    display:flex; justify-content:space-between; align-items:center; gap:10px; margin-top:12px;
  }
  .btn{
    appearance:none; border:none; cursor:pointer; user-select:none;
    background:linear-gradient(180deg,#17213b,#0f1830); color:var(--ink);
    border:1px solid rgba(148,163,184,.22); padding:10px 14px; border-radius:12px;
    font-weight:600; display:flex; align-items:center; gap:8px;
    box-shadow:0 10px 25px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,.03);
  }
  .btn:active{ transform:translateY(1px) }
  .small{ font-size:.9rem; padding:8px 12px }
  .ghost{ opacity:.8 }

  /* ====== CONFETI (canvas) ====== */
  canvas#confetti{
    position:absolute; inset:0; width:100%; height:100%;
    pointer-events:none; opacity:0; transition:opacity .35s ease;
  }
  canvas#confetti.show{ opacity:1 }

  @media (min-width:760px){
    .slide{ grid-template-columns: 52% 48%; grid-template-rows: 1fr; }
    .media{ order:1 } .text{ order:2 }
  }
</style>
</head>
<body>
  <div class="shell">
    <div class="card" id="card">
      <div class="head">
        <div>
          <div class="title">Para mi persona favorita üíñ</div>
          <div class="subtitle">Desliza ‚Ä¢ clic ‚Ä¢ teclas ‚Üê ‚Üí</div>
        </div>
        <button class="btn small ghost" id="toggleMusic" aria-pressed="false">üéµ M√∫sica: OFF</button>
      </div>

      <div class="progress"><div class="bar" id="bar"></div></div>

      <div class="slides" id="slides" aria-live="polite">
        <!-- SLIDE 1: Cambia la imagen en style="background-image: url(...)" -->
        <section class="slide active" data-text="Desde que te conoc√≠, cada d√≠a es un cap√≠tulo nuevo.">
          <div class="media" style="background:url('IMG/PRUEBA1.jpeg') center/cover no-repeat">
            <div class="ph">[Pon aqu√≠ una foto de ustedes ‚Äî Slide 1]</div>
          </div>
          <div class="text">
            <div class="type" id="type0"></div>
            <div class="hint">Tip: puedes usar ‚Üê ‚Üí o deslizar para avanzar.</div>
          </div>
        </section>

        <!-- SLIDE 2 -->
        <section class="slide" data-text="Gracias por tu risa, por tu paciencia y por hacerme la vida m√°s bonita.">
          <div class="media" style="background:url('') center/cover no-repeat">
            <div class="ph">[Pon una foto de un momento especial ‚Äî Slide 2]</div>
          </div>
          <div class="text">
            <div class="type" id="type1"></div>
            <div class="hint">Cada recuerdo contigo vale oro.</div>
          </div>
        </section>

        <!-- SLIDE 3 -->
        <section class="slide" data-text="Te prometo m√°s aventuras, m√°s abrazos y m√°s d√≠as inolvidables a tu lado.">
          <div class="media" style="background:url('') center/cover no-repeat">
            <div class="ph">[Foto de un lugar que quieran visitar ‚Äî Slide 3]</div>
          </div>
          <div class="text">
            <div class="type" id="type2"></div>
            <div class="hint">Desliza al final para la sorpresa ‚ú®</div>
          </div>
        </section>

        <!-- SLIDE 4 (final con confeti) -->
        <section class="slide" data-text="Feliz cumplea√±os, amor. Hoy, ma√±ana y siempre: te elijo a ti. üíò">
          <div class="media" style="background:url('') center/cover no-repeat">
            <div class="ph">[Una foto favorita ‚Äî Slide 4]</div>
          </div>
          <div class="text">
            <div class="type" id="type3"></div>
            <div class="hint">üéâ Sorpresa activada</div>
          </div>
        </section>

        <!-- Canvas confeti -->
        <canvas id="confetti"></canvas>
      </div>

      <div class="controls">
        <button class="btn" id="prev">‚¨ÖÔ∏è Anterior</button>
        <div class="subtitle" id="counter">1 / 4</div>
        <button class="btn" id="next">Siguiente ‚û°Ô∏è</button>
      </div>
    </div>
  </div>

<script>
/* ========= CONFIG R√ÅPIDA (EDITA ESTO) =========
   1) Cambia los textos en data-text de cada <section.slide>
   2) Pon im√°genes de fondo en cada .media (style background:url('ruta'))
   3) Si quieres m√∫sica, coloca la URL en MUSIC_URL
*/
const MUSIC_URL = "MUSIC/PRUEBA2.mp3"; // ejemplo: "musica.mp3" (deja vac√≠o para desactivar)

/* ========= L√ìGICA ========= */
const slides = [...document.querySelectorAll('.slide')];
const typeTargets = slides.map((s,i)=> document.getElementById('type'+i));
const bar = document.getElementById('bar');
const counter = document.getElementById('counter');
const confettiCanvas = document.getElementById('confetti');
const ctx = confettiCanvas.getContext('2d');
let idx = 0;
let typing = false;
let music, musicOn = false;
const toggleMusicBtn = document.getElementById('toggleMusic');

function resizeCanvas(){
  confettiCanvas.width = confettiCanvas.clientWidth;
  confettiCanvas.height = confettiCanvas.clientHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

/* ====== M√°quina de escribir ====== */
async function typeText(el, text, speed=22){
  el.textContent = "";
  typing = true;
  for (let i=0;i<text.length;i++){
    el.textContent += text[i];
    await new Promise(r=>setTimeout(r, speed + Math.random()*12));
  }
  typing = false;
}

/* ====== Navegaci√≥n ====== */
function updateUI(){
  slides.forEach((s,i)=> s.classList.toggle('active', i===idx));
  bar.style.width = ((idx+1)/slides.length*100).toFixed(2)+'%';
  counter.textContent = (idx+1)+' / '+slides.length;

  // escribir texto del slide actual
  const text = slides[idx].dataset.text || "";
  typeText(typeTargets[idx], text);

  // confeti solo en el final
  if (idx === slides.length-1){
    startConfetti();
  } else {
    stopConfetti();
  }
}

function go(n){
  if (typing) return; // evita cortar la animaci√≥n de escritura
  const next = Math.min(slides.length-1, Math.max(0, idx+n));
  if (next===idx) return;
  idx = next;
  updateUI();
}

/* ====== Controles ====== */
document.getElementById('next').addEventListener('click', ()=>go(+1));
document.getElementById('prev').addEventListener('click', ()=>go(-1));
window.addEventListener('keydown', e=>{
  if (e.key==='ArrowRight') go(+1);
  if (e.key==='ArrowLeft') go(-1);
});

/* Swipe t√°ctil */
let startX=0;
const swipeArea = document.getElementById('slides');
swipeArea.addEventListener('touchstart', e=> startX = e.touches[0].clientX, {passive:true});
swipeArea.addEventListener('touchend', e=>{
  const endX = e.changedTouches[0].clientX;
  if (startX - endX > 50) go(+1);
  if (endX - startX > 50) go(-1);
}, {passive:true});

/* M√∫sica opcional */
if (MUSIC_URL){
  music = new Audio(MUSIC_URL);
  music.loop = true;
  toggleMusicBtn.addEventListener('click', ()=>{
    musicOn = !musicOn;
    toggleMusicBtn.textContent = 'üéµ M√∫sica: ' + (musicOn ? 'ON' : 'OFF');
    toggleMusicBtn.setAttribute('aria-pressed', musicOn);
    if (musicOn) music.play().catch(()=>{ /* bloqueo del navegador */ });
    else music.pause();
  });
} else {
  toggleMusicBtn.disabled = true;
  toggleMusicBtn.classList.add('ghost');
}

/* ====== Confeti sencillo ====== */
let confettiParticles = [];
function makeConfetti(){
  confettiParticles = [];
  const w = confettiCanvas.width, h = confettiCanvas.height;
  const colors = ['#f472b6','#93c5fd','#34d399','#fbbf24','#60a5fa','#fca5a5'];
  for (let i=0;i<240;i++){
    confettiParticles.push({
      x: Math.random()*w, y: -20-Math.random()*h*0.3,
      r: 2+Math.random()*4,
      c: colors[Math.floor(Math.random()*colors.length)],
      vx: -1+Math.random()*2,
      vy: 1+Math.random()*2,
      g: 0.03+Math.random()*0.05,
      a: Math.random()*Math.PI*2,
      va: 0.02+Math.random()*0.06
    });
  }
}
let rafConfetti, runningConfetti=false;
function drawConfetti(){
  const w = confettiCanvas.width, h = confettiCanvas.height;
  ctx.clearRect(0,0,w,h);
  confettiParticles.forEach(p=>{
    p.vy += p.g; p.x += p.vx; p.y += p.vy; p.a += p.va;
    ctx.save();
    ctx.translate(p.x,p.y);
    ctx.rotate(p.a);
    ctx.fillStyle = p.c;
    ctx.fillRect(-p.r, -p.r, p.r*2, p.r*2);
    ctx.restore();
    if (p.y > h+40) { p.y = -20; p.vy = 0; }
  });
  rafConfetti = requestAnimationFrame(drawConfetti);
}
function startConfetti(){
  if (runningConfetti) return;
  confettiCanvas.classList.add('show');
  makeConfetti(); runningConfetti = true;
  rafConfetti = requestAnimationFrame(drawConfetti);
}
function stopConfetti(){
  if (!runningConfetti) return;
  confettiCanvas.classList.remove('show');
  cancelAnimationFrame(rafConfetti);
  runningConfetti = false;
  ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
}

/* init */
updateUI();
</script>
</body>
</html>
